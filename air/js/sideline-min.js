/**
 * Copyright (c) 2008-2009 Yahoo! Inc.  All rights reserved.  
 * The copyrights embodied in the content of this file are licensed by Yahoo! Inc. under 
 * the BSD (revised) open source license.
 */
YAHOO.util.Event.onDOMReady(function(){YAHOO.namespace("AIR");YAHOO.AIR.Sideline=function(){var a,c=0,b=0};YAHOO.AIR.Sideline.prototype={tabView:null,tabStore:[],showDesktopNotifications:null,searchRefreshRate:null,desktopNotificationLoader:null,searchDialogBuilder:function(){var c=this;var a=function(){var j,A=this.getData(),C=c.stripTags(YAHOO.lang.trim(A.title_of_search)),s=c.processSearchDialogData(A.q),z=c.processSearchDialogData(A.ands),r=c.processSearchDialogData(A.phrase),x=c.processSearchDialogData(A.ors),y=c.processSearchDialogData(A.nots),B=c.processSearchDialogData(A.tag),w=c.processSearchDialogData(A.from),h=c.processSearchDialogData(A.to),l=c.processSearchDialogData(A.ref),f=A.pa,p=A.na,t=A.aq;if(B.charAt(0)==="#"){B=B.substr(1,B.length)}if(w.charAt(0)==="@"){w=w.substr(1,w.length)}if(h.charAt(0)==="@"){h=h.substr(1,h.length)}if(l.charAt(0)==="@"){l=l.substr(1,l.length)}if(C===""){alert("You must provide a title for this search query!");return false}else{if(s===""&&z===""&&r===""&&x===""&&y===""&&B===""&&w===""&&h===""&&l===""&&f===false&&p===false&&t===false){alert("You must enter a valid search query!  Please try again.");return false}else{j="q="+s+"&ands="+z+"&phrase="+r+"&ors="+x+"&nots="+y+"&tag="+B+"&from="+w+"&to="+h+"&ref="+l+"&rpp="+100;if(f===true){j+="&tude[]=:)"}if(p===true){j+="&tude[]=:("}if(t===true){j+="&tude[]=?"}f=""+f+"";p=""+p+"";t=""+t+"";var g=YAHOO.util.Dom.get("search_to_update").value,k=c.getCurrentGrpId(),o={group_id:k,search_title:C,actual_query_string:j,q:s,ands:z,ors:x,nots:y,phrase:r,tag:B,user_from:w,user_to:h,ref:l,pa:f,na:p,aq:t};if(g===""){var m=c.addSearchItem(o);if(m.data!==null){var n=c.create("li");n.id="search__"+m.data[0].id;YAHOO.util.Dom.addClass(n,"search_string_item");n.innerHTML=C;var i=YAHOO.util.Dom.getElementsByClassName("search_string_item","li","active_search_strings").length;var u=YAHOO.util.Dom.getLastChild("active_search_strings");YAHOO.util.Dom.insertAfter(n,u);if(i==="undefined"||i===0){var e=YAHOO.util.Dom.getFirstChild("active_search_strings");c.remove(e)}this.hide();YAHOO.util.Dom.get("add_search_form").reset()}else{alert("Unable to add new search string!  Please try again.")}}else{c.updateSearchItem(g,o);YAHOO.util.Dom.get("search__"+g).innerHTML=C;this.hide();c.removeSearchTermTweets(k,g);var v=YAHOO.util.Dom.get("summary-group-"+k);if(!v.hasChildNodes()){v.innerHTML='<p id="emptygroup__'+k+'">This group has no search results yet!</p>'}YAHOO.util.Dom.get("add_search_form").reset()}c.doIntermediateDataRotation.call(c)}}};var d=function(){YAHOO.util.Dom.get("add_search_form").reset();this.cancel()};var b=function(){var g=YAHOO.util.Dom.get("search_to_update").value,f=YAHOO.util.Dom.getElementsByClassName("search_string_item","li","active_search_strings").length;if(g!==""){c.removeSearchItem(g);c.fadeThisOut(YAHOO.util.Dom.get("search__"+g),true);c.removeSearchTermTweets(c.getCurrentGrpId(),g);if(f==="undefined"||f<=1){var e=YAHOO.util.Dom.get("active_search_strings");e.innerHTML='<li class="list_message">This group has no searches defined!</li>'}YAHOO.util.Dom.get("add_search_form").reset();this.cancel()}};this.searchDialog=new YAHOO.widget.Dialog("add_search_dialog",{width:"435px",fixedcenter:true,visible:false,modal:true,draggable:false,underlay:"none",postmethod:"none",constraintoviewport:true,buttons:[{text:"Delete",handler:b},{text:"Submit",handler:a},{text:"Cancel",handler:d}]});this.searchDialog.render();YAHOO.util.Event.addListener("add_search_dialog","keypress",function(f){if(f.keyCode&&f.keyCode===13){YAHOO.util.Event.preventDefault(f)}});YAHOO.util.Event.addListener("add_search_form","click",function(g){var f=YAHOO.util.Event.getTarget(g),i=YAHOO.util.Dom.get("title_of_search"),h=i.value;if(f.id==="show_simple_search"){YAHOO.util.Event.preventDefault(g);YAHOO.util.Dom.get("add_search_form").reset();i.value=h;YAHOO.util.Dom.setStyle("advanced_search","display","none");YAHOO.util.Dom.setStyle("simple_search","display","")}else{if(f.id==="show_advanced_search"){YAHOO.util.Event.preventDefault(g);YAHOO.util.Dom.get("add_search_form").reset();i.value=h;YAHOO.util.Dom.setStyle("simple_search","display","none");YAHOO.util.Dom.setStyle("advanced_search","display","")}}})},searchGrpDialogBuilder:function(){var b=this;var a=function(){var g=this.getData(),f=b.stripTags(YAHOO.lang.trim(g.search_group_title));if(f===""){alert("You must provide a title for this search group!");return false}else{var d,h=b.addNewSearchGroup(f);if(h.data!==null){b.remove(YAHOO.util.Dom.get("add_new_group"));d=b.buildTabText(f);b.tabView.addTab(new YAHOO.widget.Tab({label:d,active:true,content:'<div id="summary-group-'+h.data[0].id+'" class="tweet-container summary-group-'+h.data[0].id+'"><p id="emptygroup__'+h.data[0].id+'">This group has no search results yet!</p><div>'}));b.setupNewTabButton();b.refreshTabStore();var e=YAHOO.util.Dom.get("active_search_strings");e.innerHTML='<li class="list_message">This group has no searches defined!</li>';this.hide();YAHOO.util.Dom.get("add_search_group_form").reset();YAHOO.util.Dom.setStyle("add_new_search","visibility","visible")}else{alert("Unable to add new Search Group!  Please try again.")}}};var c=function(){YAHOO.util.Dom.get("add_search_group_form").reset();this.cancel()};this.searchGrpDialog=new YAHOO.widget.Dialog("add_search_group_dialog",{width:"250px",fixedcenter:true,visible:false,modal:true,draggable:false,underlay:"none",postmethod:"none",constraintoviewport:true,buttons:[{text:"Submit",handler:a},{text:"Cancel",handler:c}]});this.searchGrpDialog.render();YAHOO.util.Event.addListener("add_search_group_dialog","keypress",function(d){if(d.keyCode&&d.keyCode===13){YAHOO.util.Event.preventDefault(d)}})},searchRateDialogBuilder:function(){var b=this;var a=function(){b.searchRefreshRate=Number(YAHOO.lang.trim(YAHOO.util.Dom.get("slider-converted-value").innerHTML));b.saveUserPreferences();b.doIntermediateDataRotation.call(b);this.cancel()};var c=function(){YAHOO.AIR.Sideline.slider.setValue((b.searchRefreshRate/6)*20,false);this.cancel()};this.searchRateDialog=new YAHOO.widget.Dialog("search_rate_dialog",{width:"250px",fixedcenter:true,visible:false,modal:true,draggable:false,underlay:"none",postmethod:"none",constraintoviewport:true,buttons:[{text:"Submit",handler:a},{text:"Cancel",handler:c}]});this.searchRateDialog.render();YAHOO.util.Event.addListener("search_rate_dialog","keypress",function(d){if(d.keyCode&&d.keyCode===13){YAHOO.util.Event.preventDefault(d)}})},renameSearchGrpDialogBuilder:function(){var b=this;var a=function(){var g=this.getData(),d=b.stripTags(YAHOO.lang.trim(g.new_search_group_title)),f=b.stripTags(YAHOO.lang.trim(g.old_search_group_title));if(d===""||(d===f)){alert("You must provide a new title for this search group!");return false}else{var e=b.buildTabText(d),h=b.updateSearchGroup(f,d);b.tabStore[h].label=e;b.tabStore[h].nodeReference.innerHTML=e;b.refreshTabStore();this.hide();YAHOO.util.Dom.get("rename_search_group_form").reset()}};var c=function(){YAHOO.util.Dom.get("rename_search_group_form").reset();this.cancel()};this.renameSearchGrpDialog=new YAHOO.widget.Dialog("rename_search_group_dialog",{width:"250px",fixedcenter:true,visible:false,modal:true,draggable:false,underlay:"none",postmethod:"none",constraintoviewport:true,buttons:[{text:"Submit",handler:a},{text:"Cancel",handler:c}]});this.renameSearchGrpDialog.render();YAHOO.util.Event.addListener("rename_search_group_dialog","keypress",function(d){if(d.keyCode&&d.keyCode===13){YAHOO.util.Event.preventDefault(d)}})},searchItemRemovalDialog:function(b,e){var d=this;var c=function(){d.removeSearchItem(b);d.fadeThisOut(e,true);this.hide()};var a=function(){this.hide()};this.searchItemRemoval=new YAHOO.widget.SimpleDialog("searchItemRemoval",{width:"300px",fixedcenter:true,visible:false,draggable:false,underlay:"none",modal:true,close:true,text:"Are you sure you want to remove this search item?",icon:YAHOO.widget.SimpleDialog.ICON_WARN,constraintoviewport:true,buttons:[{text:"Yes",handler:c},{text:"No",handler:a}]});this.searchItemRemoval.setHeader("Confirmation Dialog");this.searchItemRemoval.render("search_item_simpledialog")},searchGrpRemovalDialog:function(){var c=this;var b=function(){var d=YAHOO.util.Selector.query("li.selected a em"),f=d[0].innerHTML;if(f!=="Favorites"){var h=c.getCurrentGrpId(),g="summary-group-"+h,e=YAHOO.util.Dom.get(g);if(h!=="undefined"){c.removeTabData(h);YAHOO.util.Event.purgeElement(e,true);c.tabStore[h].nodeReference=null;c.tabView.removeTab(c.tabView.get("activeTab"))}}else{alert("The favorites group cannot be removed!")}this.hide();c.refreshTabStore()};var a=function(){this.hide()};this.searchGrpRemoval=new YAHOO.widget.SimpleDialog("searchGrpRemoval",{width:"300px",fixedcenter:true,visible:false,draggable:false,underlay:"none",modal:true,close:true,text:"Are you sure you want to remove this search group?",icon:YAHOO.widget.SimpleDialog.ICON_WARN,constraintoviewport:true,buttons:[{text:"Yes",handler:b},{text:"No",handler:a}]});this.searchGrpRemoval.setHeader("Confirmation Dialog");this.searchGrpRemoval.render("search_item_simpledialog")},setupSidelineTabs:function(){var l=this,n=this.getAllSidelineGroups();this.tabView.addTab(new YAHOO.widget.Tab({label:this.buildTabText("Trends"),active:false,content:'<div id="trending_content" class="tweet-container"><p>Popular topics right now</p><div id="twitter_trend_list"><p>Loading trends...<img src="images/search_in_progress.gif" alt="loading" /></p></div><p id="twitter_trend_asof"></p></div>'}));for(var k=0;k<n.data.length;k++){var e="",a=[],h="",m=this.getTweets(n.data[k].id);a[a.length]='<div id="summary-group-'+n.data[k].id+'" class="tweet-container summary-group-'+n.data[k].id+'">';if(m.data!==null){var o=0,g,d=m.data.length;for(g=0;g<d;g++){var p,b,f;if(n.data[k].group_name==="Favorites"){p="delete_button";b="remove";f="Remove this Tweet"}else{p="fav_button";b="fav";f="Favorite this Tweet"}a[a.length]='<div class="single-tweet search-term-'+m.data[g].searches_id+" detail-group-"+n.data[k].id+'" id="tweet__'+m.data[g].id+"__"+m.data[g].twitter_id+'">';a[a.length]='<div class="tweet-container-left">';a[a.length]='<img height="48" width="48" class="profile_image" src="'+m.data[g].profile_image_url+'" alt="'+m.data[g].from_user+'" />';a[a.length]="</div>";a[a.length]='<div class="tweet-container-center">';a[a.length]='<p class="tweet_text" id="db_'+m.data[g].id+'">';a[a.length]='<a title="open in browser" style="text-decoration: underline;" class="tweet_link" href="http://twitter.com/'+encodeURIComponent(m.data[g].from_user)+'">'+m.data[g].from_user+"</a>&nbsp;"+m.data[g].text;a[a.length]="</p>";a[a.length]='<p class="tweet-date">'+m.data[g].created_at+"</p>";a[a.length]="</div>";a[a.length]='<div class="tweet-container-right">';a[a.length]='<span title="'+f+'" class="fav_reply_remove '+p+'" id="'+b+"__"+m.data[g].twitter_id+"__"+m.data[g].from_user+'"></span>';a[a.length]='<span title="Reply to Tweet" class="fav_reply_remove reply_button" id="reply__'+m.data[g].twitter_id+"__"+m.data[g].from_user+'"></span>';a[a.length]="</div>";a[a.length]='<br class="clear" />';a[a.length]="</div>"}}else{a[a.length]='<p id="emptygroup__'+n.data[k].id+'">This group has no search results yet!</p>'}a[a.length]="</div>";e=a.join("");h=this.buildTabText(n.data[k].group_name);this.tabView.addTab(new YAHOO.widget.Tab({label:h,content:e,active:false}));this.tabView.appendTo("tweetainer")}this.refreshTabStore();this.setupNewTabButton();this.tabView.addListener("activeTabChange",function(q){var i=l.getCurrentGrpId();if(i!=="undefined"){var j=l.getSidelineGroupQueries(i)||"undefined",c=YAHOO.util.Dom.get("active_search_strings");if(i===l.tabStore.favoritesGrpID){YAHOO.util.Dom.replaceClass(YAHOO.util.Dom.get("favs-tab-label"),"inactive","active");YAHOO.util.Dom.replaceClass(YAHOO.util.Dom.get("trends-tab-label"),"active","inactive");YAHOO.util.Dom.setStyle("add_new_search","visibility","hidden");c.innerHTML='<li class="list_message">The Favorites group does not contain specific search items. Instead it contains a collection of your favorite search results.</li>';YAHOO.util.Dom.get("search_group_result_count").innerHTML=""}else{if(i===l.tabStore.trendsGrpID){YAHOO.util.Dom.replaceClass(YAHOO.util.Dom.get("trends-tab-label"),"inactive","active");YAHOO.util.Dom.replaceClass(YAHOO.util.Dom.get("favs-tab-label"),"active","inactive");YAHOO.util.Dom.setStyle("add_new_search","visibility","hidden");c.innerHTML='<li class="list_message">The Trends group does not contain specific search items. Instead it contains a collection of topics currently trending in Twitter.</li>';YAHOO.util.Dom.get("search_group_result_count").innerHTML=""}else{YAHOO.util.Dom.replaceClass(YAHOO.util.Dom.get("favs-tab-label"),"active","inactive");YAHOO.util.Dom.replaceClass(YAHOO.util.Dom.get("trends-tab-label"),"active","inactive");YAHOO.util.Dom.setStyle("add_new_search","visibility","visible");if(j!=="undefined"){l.updateActiveSearchList(j)}l.tabStore[i].newTweetCount=0;l.tabStore[i].nodeReference.innerHTML=l.buildTabText(l.tabStore[i].label,0);YAHOO.util.Dom.get("search_group_result_count").innerHTML="Search Group Total: "+l.tabStore[i].totalTweetCount}}}});this.tabView.set("activeIndex",0)},setupNewTabButton:function(){var b,a=YAHOO.util.Dom.getLastChild(YAHOO.util.Dom.getElementsByClassName("yui-nav","ul","tweetainer")[0]);b=this.create("img");b.id="add_new_group";b.src="images/add_search_group.png";YAHOO.util.Dom.addClass(b,"new-tab-button");YAHOO.util.Dom.insertAfter(b,a);YAHOO.util.Event.on("add_new_group","click",function(){this.searchGrpDialog.show()},this,true)},doIntermediateDataRotation:function(){var a=this;clearInterval(this.rotationTimer);if(!YAHOO.lang.isNull(this.desktopNotificationLoader)){this.desktopNotificationLoader.stage.nativeWindow.close()}this.dataRotation();this.rotationTimer=setInterval(function(){a.doIntermediateDataRotation.call(a)},a.searchRefreshRate*60000)},activeSearchHandler:function(f){var b=YAHOO.util.Event.getTarget(f);if(YAHOO.util.Dom.hasClass(b,"search_string_item")){var c=b.id.split("__"),a=c[1];this.restoreSearchItemDialog(a);this.searchDialog.show()}else{if(b.id==="add_new_search"){var d=this.getCurrentGrpId();if(d!=="undefined"){if(d===this.tabStore.favoritesGrpID||d===this.tabStore.trendsGrpID){alert("You cannot define search conditions for this group!")}else{var g=YAHOO.util.Dom.get("yui-gen0");YAHOO.util.Dom.addClass(g,"yui-button-disabled");YAHOO.util.Dom.get("search_to_update").value="";YAHOO.util.Dom.setStyle("advanced_search","display","none");YAHOO.util.Dom.setStyle("simple_search","display","");this.searchDialog.show()}}}}},restoreSearchItemDialog:function(l){function f(t){var q;if(YAHOO.lang.isString(t)){q=t.replace(/\+/g," ")}else{q=""}return q}var p=this.getSearchItemParams(l);if(YAHOO.lang.isObject(p.data)&&p.data[0].id!=="undefined"){var b=p.data[0],g=b.search_title,j=f(b.q),o=f(b.ands),m=f(b.ors),n=f(b.nots),h=f(b.phrase),r=f(b.tag),s=f(b.user_from),i=f(b.user_to),c=f(b.ref),a=b.pa,e=b.na,k=b.aq;YAHOO.util.Dom.get("title_of_search").value=g;YAHOO.util.Dom.get("q").value=j;YAHOO.util.Dom.get("ands").value=o;YAHOO.util.Dom.get("ors").value=m;YAHOO.util.Dom.get("nots").value=n;YAHOO.util.Dom.get("phrase").value=h;YAHOO.util.Dom.get("tag").value=r;YAHOO.util.Dom.get("from").value=s;YAHOO.util.Dom.get("to").value=i;YAHOO.util.Dom.get("ref").value=c;YAHOO.util.Dom.get("search_to_update").value=l;if(a==="true"){YAHOO.util.Dom.get("pa").checked=true}if(e==="true"){YAHOO.util.Dom.get("na").checked=true}if(k==="true"){YAHOO.util.Dom.get("aq").checked=true}if(j===""){YAHOO.util.Dom.setStyle("simple_search","display","none");YAHOO.util.Dom.setStyle("advanced_search","display","")}else{YAHOO.util.Dom.setStyle("advanced_search","display","none");YAHOO.util.Dom.setStyle("simple_search","display","")}var d=YAHOO.util.Dom.get("yui-gen0");YAHOO.util.Dom.removeClass(d,"yui-button-disabled")}},addToTab:function(h){var f=new Date(h.created_at),c=f.toLocaleString(),e="",a=[];a[a.length]='<div class="tweet-container-left">';a[a.length]='<img height="48" width="48" class="profile_image" src="'+h.profile_image_url+'" alt="'+h.from_user+'" />';a[a.length]="</div>";a[a.length]='<div id="tweet-gid'+h.group_id+"-tid"+h.twitter_id+'" class="tweet-container-center">';a[a.length]='<p class="tweet_text" id="db_'+h.twitter_id+'">';a[a.length]='<a style="text-decoration: underline;" class="tweet_link" href="http://twitter.com/'+h.from_user+'">'+h.from_user+"</a>&nbsp;";a[a.length]=h.tweet_text;a[a.length]="</p>";a[a.length]='<p class="tweet-date">'+c+"</p>";a[a.length]="</div>";a[a.length]='<div class="tweet-container-right">';a[a.length]='<span title="Favorite this Tweet" class="fav_reply_remove fav_button" id="fav__'+h.twitter_id+"__"+h.from_user+'"></span>';a[a.length]='<span title="Reply to Tweet" class="fav_reply_remove reply_button reply_button" id="reply__'+h.twitter_id+"__"+h.from_user+'"></span>';a[a.length]="</div>";a[a.length]='<br class="clear" />';e=a.join("");var g=this.create("div");g.id="tweet__"+h.local_tweet_id+"__"+h.twitter_id;g.className="single-tweet detail-group-"+h.group_id+" search-term-"+h.searches_id;g.innerHTML=e;var b=this.findFirstTweet(h.group_id)||"undefined";YAHOO.util.Dom.insertBefore(g,b);var d=YAHOO.util.Dom.get(g.id);this.fadeThisIn(d);var i=YAHOO.util.Dom.get("emptygroup__"+h.group_id)||"undefined";if(i!=="undefined"){this.remove(i)}},removeSearchTermTweets:function(f,e){var a="DELETE FROM tweets WHERE searches_id = "+Number(e);this.doQuery(a);var b,h="search-term-"+e,d="summary-group-"+f,g=YAHOO.util.Dom.getElementsByClassName(h,"div",d),c=g.length;for(b=0;b<c;b++){this.remove(g[b])}this.tabStore[f].totalTweetCount=this.tabStore[f].totalTweetCount-c;YAHOO.util.Dom.get("search_group_result_count").innerHTML="Search Group Total: "+this.tabStore[f].totalTweetCount},getRawTabText:function(b){var a=b.replace(/<span.*><\/span>/,"");a=YAHOO.lang.trim(a.replace(/\(\d+\)/gi,""));return a},buildTabText:function(c,b){var d=this.getRawTabText(c),a=d;if(!YAHOO.lang.isUndefined(b)&&b>0){a+=" ("+b+")"}if(d!=="Trends"&&d!=="Favorites"){a+='<span class="close-search-group"></span>'}else{if(d==="Trends"){a+='<span id="trends-tab-label" class="active"></span>'}else{if(d==="Favorites"){a+='<span id="favs-tab-label" class="inactive"></span>'}}}return a},refreshTabStore:function(){var e=this,a,b,h,d,c,i,g=YAHOO.util.Selector.query("ul.yui-nav li a em");this.tabStore.tabCount=g.length;for(var j=0;j<g.length;j++){d=this.getRawTabText(g[j].innerHTML);if(d!=="Trends"){a=this.getGroupIdFromString(d);b=Number(a.data[0].id);h=this.getTweetCountForSearchGroup(b);if(YAHOO.lang.isUndefined(this.tabStore[b])){this.tabStore[b]={nodeReference:g[j],label:g[j].innerHTML,newTweetCount:0,totalTweetCount:h}}}}if(YAHOO.lang.isUndefined(this.tabStore.favoritesGrpID)){var f=this.getGroupIdFromString("Favorites");this.tabStore.favoritesGrpID=Number(f.data[0].id)}if(YAHOO.lang.isUndefined(this.tabStore.trendsGrpID)){this.tabStore.trendsGrpID=-1}YAHOO.util.Event.on(g,"dblclick",function(l){var k=YAHOO.util.Event.getTarget(l),m=e.getRawTabText(k.innerHTML);if(m!=="Trends"&&m!=="Favorites"){YAHOO.util.Dom.get("new_search_group_title").value=m;YAHOO.util.Dom.get("old_search_group_title").value=m;e.renameSearchGrpDialog.show()}})},updateActiveSearchList:function(c){var e,a="",f=YAHOO.util.Dom.get("active_search_strings");if(c.data!==null){var b=c.data.length||"undefined";for(e=0;e<b;e++){var g=c.data[e].id,d=c.data[e].search_title;a+='<li id="search__'+g+'" class="search_string_item">'+d+"</li>"}f.innerHTML=a}else{f.innerHTML='<li class="list_message">This group has no searches defined!</li>'}},doTwitterSearch:function(g,a,f,e,d){var c=this;var b=new XMLHttpRequest();b.onreadystatechange=function(){if(b.readyState===4){try{var h=YAHOO.lang.JSON.parse(b.responseText);g.call(c,h,f,e,d)}catch(i){air.trace("Unabled to parse JSON")}}};b.open("GET",a,true);b.send(null)},fetchExternalJSONData:function(d,a){var c=this,b=new XMLHttpRequest();b.onreadystatechange=function(){if(b.readyState===4){try{var f=YAHOO.lang.JSON.parse(b.responseText);d.call(c,f)}catch(g){air.trace("Unabled to parse JSON")}}};b.open("GET",a,true);b.send(null)},healthCheck:function(a){if(!YAHOO.lang.isUndefined(a.status)&&a.status!==200){this.rotationTimer=null;YAHOO.util.Dom.get("bd").innerHTML=a.status_message;YAHOO.util.Dom.addClass("bd","maintenance_mode")}},processNewTweets:function(w,n,p,v){var r=0;this.rotationJobCount--;if(YAHOO.lang.isObject(w)&&YAHOO.lang.isObject(w.results)&&w.results.length>0){for(var q=w.results.length-1;q>=0;q--){var l,k,m=this.stripTags(w.results[q].text),u=w.results[q].to_user_id,f=w.results[q].from_user,j=w.results[q].id,d=w.results[q].from_user_id,c=w.results[q].profile_image_url,a=w.results[q].created_at,h=YAHOO.util.Dom.get("tweet-gid"+p+"-tid"+j)||"undefined";if(YAHOO.lang.isUndefined(h)||h==="undefined"){r=r+1;var s=new RegExp("((http|https|ftp|sftp)://.*)?("+n+")","gi");var o=m.replace(s,function(i,e){return e?i:'<span class="matched_search">'+i+"</span>"});o=o.replace(/((\w+):\/\/[\S]+\b)/gim,'<a title="open in browser" class="tweet_link" href="$1" target="_blank">$1</a>');o=o.replace(/@(\w+)/gim,'<a title="open in browser" class="tweet_link" href="http://twitter.com/$1" target="_blank">@$1</a>');try{l=this.addTweet(o,u,f,j,d,c,a,p,v);if(l.data!==null){k=l.data[0].id}}catch(t){alert("Unable to add new tweet to database!")}var b={local_tweet_id:k,tweet_text:o,to_user_id:u,from_user:f,twitter_id:j,from_user_id:d,profile_image_url:c,created_at:a,group_id:p,searches_id:v};this.addToTab(b)}}this.tabStore[p].totalTweetCount+=r;this.rotationTotal+=r;if(p!==this.getCurrentGrpId()){this.tabStore[p].newTweetCount+=r;this.tabStore[p].nodeReference.innerHTML=this.buildTabText(this.tabStore[p].label,this.tabStore[p].newTweetCount)}if(p!==this.tabStore.favoritesGrpID&&p!==this.tabStore.trendsGrpID){try{YAHOO.util.Dom.get("search_group_result_count").innerHTML="Search Group Total: "+this.tabStore[this.getCurrentGrpId()].totalTweetCount}catch(t){}}}if(this.showDesktopNotifications===1&&this.rotationJobCount===0&&this.rotationTotal>0){this.displaySearchResultNotification(this.rotationTotal)}var g=this.getMaxTwitterIdForSearchTerm(v);if(!YAHOO.lang.isNull(w)){this.updateMaxTwitterIdForSearchTerm(g.data[0].twitter_id,v)}},handleTweetReplyFavRemove:function(c){var e=c.id.split("__"),f=e[0],n=e[1],j=e[2],h=this.tabStore.favoritesGrpID,b="summary-group-"+h,m,d;if(f==="reply"){this.openInBrowser("http://twitter.com/home?status=@"+j)}else{if(f==="remove"){m=c.parentNode;d=m.parentNode;this.fadeThisOut(d,true);this.removeTweet(n);if(YAHOO.util.Dom.getChildren(b).length<=1){YAHOO.util.Dom.get(b).innerHTML='<p id="emptygroup__'+h+'">This group has no search results yet!</p>'}}else{if(f==="fav"){c.id="remove__"+n+"__"+j;YAHOO.util.Dom.replaceClass(c,"fav_button","delete_button");m=c.parentNode;d=m.parentNode;var l=YAHOO.util.Dom.get(d).cloneNode(true),k=YAHOO.util.Dom.get(d).className,g="emptygroup__"+h,i=YAHOO.util.Dom.get(g)||"undefined";YAHOO.util.Dom.replaceClass(l,k,"single-tweet detail-group-"+h);if(i==="undefined"){var a=this.findFirstTweet(h)||"undefined";YAHOO.util.Dom.insertBefore(l,a)}else{YAHOO.util.Dom.insertAfter(l,i);this.remove(i)}YAHOO.util.Dom.setStyle(c,"visibility","hidden");this.markAsFavorite(n)}}}},fadeThisOut:function(b,c){var d=this,a;a=new YAHOO.util.Anim(b,{opacity:{to:0}},1,YAHOO.util.Easing.easeOut);a.animate();a.onComplete.subscribe(function(){if(c===true){d.remove(b)}else{YAHOO.util.Dom.setStyle(b,"display","none")}})},fadeThisIn:function(c){var b={backgroundColor:{from:"#FFFF99",to:"#171717"}};var a=new YAHOO.util.ColorAnim(c,b);a.animate()},setupTooltip:function(){var a=new YAHOO.widget.Overlay("tooltip",{context:["ctt","tl","br"],visible:false,fixedcenter:true,width:"300px",height:"auto",underlay:"shadow"});a.render();YAHOO.util.Event.addListener("information","mouseover",a.show,a,true);YAHOO.util.Event.addListener("information","mouseout",a.hide,a,true)},setupRefreshRateSlider:function(){var a="slider-bg",d="slider-converted-value",b=18,c=20;YAHOO.AIR.Sideline.slider=YAHOO.widget.Slider.getHorizSlider("slider-bg","slider-thumb",0,200,20);YAHOO.AIR.Sideline.slider.animate=true;YAHOO.AIR.Sideline.slider.setValue((this.searchRefreshRate/6)*20,false);YAHOO.AIR.Sideline.slider.getRealValue=function(){var e=Math.round(this.getValue()*b)/60;if(e===0){e=1}return e};YAHOO.AIR.Sideline.slider.subscribe("change",function(g){var e=YAHOO.util.Dom.get(d),f=YAHOO.AIR.Sideline.slider.getRealValue();e.innerHTML=f;YAHOO.util.Dom.get(a).title="slider value = "+f})},getCurrentGrpId:function(){var c,a=YAHOO.util.Selector.query("li.selected a em"),b=this.getRawTabText(a[0].innerHTML);if(b==="Trends"){return -1}else{c=this.getGroupIdFromString(b)||"undefined";if(c==="undefined"){return"undefined"}else{return c.data[0].id}}},findFirstTweet:function(a){var b=YAHOO.util.Dom.get("summary-group-"+a)||"undefined";if(b!=="undefined"){var c=YAHOO.util.Dom.getFirstChild(b)||"undefined";if(c!=="undefined"){return c}}return false}};YAHOO.AIR.SidelineUtil=function(){};YAHOO.AIR.SidelineUtil.prototype={dataRotation:function(){var c,d="http://search.twitter.com/search.json?",g=this.getAllSidelineGroups(),k=g.data.length;this.rotationJobCount=this.getCountOfActiveQueries();this.rotationTotal=0;if(k>0){this.doProgressIndicator(1);for(c=0;c<k;c++){var b,n,m,l,h=0,a=this.getSidelineGroupQueries(g.data[c].id);if(a.data!==null){h=a.data.length;for(b=0;b<h;b++){n=d+a.data[b].actual_query_string+"&lang=all";if(a.data[b].twitter_starting_point!==""&&a.data[b].twitter_starting_point>0){n+="&since_id="+a.data[b].twitter_starting_point}l="";if(a.data[b].q!==""){m=a.data[b].q;if(m.charAt(0)==='"'){m=m.substr(1,m.length)}if(m.charAt(m.length-1)==='"'){m=m.substr(0,m.length-1)}m=m.replace(/\+or\+/gi,"|");m=m.replace(/\+/g,"|");l+=m.replace(/"\|"/g,"|")}if(a.data[b].ands!==""){l+=a.data[b].ands.replace(/\+/ig,"|")}if(a.data[b].ors!==""){l+=a.data[b].ors.replace(/\+/ig,"|")}if(a.data[b].phrase!==""){l+=a.data[b].phrase.replace(/\+/ig," ")}if(a.data[b].tag!==""){l+=a.data[b].tag.replace(/\+/ig," ")}if(a.data[b].user_from!==""){l+=a.data[b].user_from.replace(/\+/ig," ")}if(a.data[b].user_to!==""){l+=a.data[b].user_to.replace(/\+/ig," ")}if(a.data[b].ref!==""){l+=a.data[b].ref.replace(/\+/ig," ")}try{this.doTwitterSearch(this.processNewTweets,encodeURI(n).replace(/#/g,"%23"),l,g.data[c].id,a.data[b].id)}catch(f){}}}}this.doProgressIndicator(0)}},getTwitterTrends:function(){if(!YAHOO.lang.isUndefined(this.tabStore.trendsGrpID)){try{this.fetchExternalJSONData(this.processTwitterTrends,"http://search.twitter.com/trends.json")}catch(a){}}else{this.refreshTabStore()}},processTwitterTrends:function(h){if(YAHOO.lang.isObject(h)&&YAHOO.lang.isObject(h.trends)&&h.trends.length>0){var a="",b=[],e=new Date(h.as_of),d=e.toLocaleString(),g=YAHOO.util.Dom.get("twitter_trend_list"),c=YAHOO.util.Dom.get("twitter_trend_asof");for(var f=0;f<h.trends.length;f++){b[f]='<div class="trend_node"><div class="trend_preview_header"><img class="trend_arrow closed" src="../images/closed_arrow.png" alt="closed" /><span class="trend_title">&nbsp;'+h.trends[f].name+'</span><a title="'+h.trends[f].name+'" class="trend_item" href="'+h.trends[f].url+'"></a></div><div id="trend_item_'+f+'" class="trend_preview_container" rel="'+h.trends[f].url+'&rpp=3"></div></div>'}a=b.join("");g.innerHTML=a;c.innerHTML="Note: these are as of "+d}},handleTrendEvents:function(m,k){var g=YAHOO.util.Event.getTarget(m);if(YAHOO.util.Dom.hasClass(g,"trend_arrow")){var n=YAHOO.util.Dom.getNextSibling(g.parentNode),b=YAHOO.util.Dom.getAttribute(n,"id"),c=YAHOO.util.Dom.getAttribute(n,"rel"),q=c.replace("http://search.twitter.com/search?","http://search.twitter.com/search.json?");if(YAHOO.util.Dom.hasClass(g,"closed")){g.setAttribute("src","../images/open_arrow.png");n.innerHTML='<img src="../images/search_in_progress.gif" alt="search in progress" />';YAHOO.util.Dom.replaceClass(g,"closed","open");YAHOO.util.Dom.setStyle(n,"display","block");var o=new XMLHttpRequest();o.onreadystatechange=function(){if(o.readyState===4){try{var r=YAHOO.lang.JSON.parse(o.responseText);k.updateTrendPreview(r,b,k.tabStore.trendsGrpID)}catch(s){}}};o.open("GET",q,true);o.send(null)}else{g.setAttribute("src","../images/closed_arrow.png");YAHOO.util.Dom.replaceClass(g,"open","closed");YAHOO.util.Dom.setStyle(n,"display","none")}}else{if(YAHOO.util.Dom.hasClass(g,"trend_item")){YAHOO.util.Event.preventDefault(m);var i,j,h=g.href,f=h.split("?q="),a=decodeURIComponent(f[1]),p=g.title,l=this.addNewSearchGroup(p),d="q="+a+"&ands=&phrase=&ors=&nots=&tag=&from=&to=&ref=&rpp=100";if(l.data!==null){j={group_id:l.data[0].id,search_title:p,actual_query_string:d,q:a,ands:"",ors:"",nots:"",phrase:"",tag:"",user_from:"",user_to:"",ref:"",pa:"false",na:"false",aq:"false"};this.addSearchItem(j);i=this.buildTabText(p);this.tabView.addTab(new YAHOO.widget.Tab({label:i,active:false,content:'<div id="summary-group-'+l.data[0].id+'" class="tweet-container summary-group-'+l.data[0].id+'"><p id="emptygroup__'+l.data[0].id+'">This group has no search results yet!</p><div>'}));this.remove(YAHOO.util.Dom.get("add_new_group"));this.refreshTabStore();this.setupNewTabButton();this.tabView.set("activeIndex",this.tabStore.tabCount-1);this.doIntermediateDataRotation()}}}},updateTrendPreview:function(c,h,g){var b,f,e=[],a=YAHOO.util.Dom.get(h);for(var d=0;d<c.results.length;d++){b=c.results[d].text;b=b.replace(/((\w+):\/\/[\S]+\b)/gim,'<a title="open in browser" class="tweet_link" href="$1" target="_blank">$1</a>');b=b.replace(/@(\w+)/gim,'<a title="open in browser" class="tweet_link" href="http://twitter.com/$1" target="_blank">@$1</a>');e[e.length]="<div>";e[e.length]='<div class="tweet-preview-container-left">';e[e.length]='<img height="48" width="48" class="profile_image" src="'+c.results[d].profile_image_url+'" alt="'+c.results[d].from_user+'" />';e[e.length]="</div>";e[e.length]='<div class="tweet-preview-container-center">';e[e.length]='<p class="tweet_text" id="db_'+c.results[d].id+'">';e[e.length]='<a title="open in browser" style="text-decoration: underline;" class="tweet_link" href="http://twitter.com/'+encodeURIComponent(c.results[d].from_user)+'">'+c.results[d].from_user+"</a>&nbsp;"+b;e[e.length]="</p>";e[e.length]='<p class="tweet-date">'+c.results[d].created_at+"</p>";e[e.length]="</div>";e[e.length]='<br class="clear" />';e[e.length]="</div>";e[e.length]='<br class="clear" />'}f=e.join("");a.innerHTML=f},processSearchDialogData:function(a){var b=this.stripTags(YAHOO.lang.trim(a));return b.replace(/ /gi,"+")},displaySearchResultNotification:function(){var e=this,a=new air.NativeWindowInitOptions();a.type="lightweight";a.transparent=true;a.systemChrome=air.NativeWindowSystemChrome.NONE;var b,d,f=air.Screen.mainScreen.visibleBounds,c=new air.Rectangle(f.right-300-40,40,300,200);this.desktopNotificationLoader=air.HTMLLoader.createRootWindow(true,a,true,c);this.desktopNotificationLoader.paintsDefaultBackground=false;b='<html><head><title>Sideline Notification</title></head><body style="opacity: 0.5;"><div style="color: white; background-color: black; padding: 20px; margin: 10px; -webkit-border-radius: 10px; -webkit-box-shadow: 0px 0px 10px #000;"><h1 style="font-size: 14px;">Sideline Notification</h1><p style="font-size: 12px;">You have '+this.rotationTotal+" new search results</p></div></body></html>";this.desktopNotificationLoader.loadString(b);this.desktopNotificationLoader.stage.nativeWindow.alwaysInFront=true;this.desktopNotificationLoader.stage.nativeWindow.height=this.desktopNotificationLoader.window.document.height;d=setTimeout(function(){try{e.desktopNotificationLoader.stage.nativeWindow.close();e.desktopNotificationLoader=null}catch(g){}},5000);this.desktopNotificationLoader.addEventListener("click",function(){clearTimeout(d);try{e.desktopNotificationLoader.stage.nativeWindow.close();e.desktopNotificationLoader=null}catch(g){}})},doSidelineUpdateCheck:function(){var a=new runtime.air.update.ApplicationUpdaterUI();a.updateURL="http://sideline.yahoo.com/updater/update.xml";a.addEventListener(runtime.air.update.events.UpdateEvent.INITIALIZED,function(){a.checkNow()});a.addEventListener(runtime.flash.events.ErrorEvent.ERROR,function(){alert(event)});a.isCheckForUpdateVisible=false;a.isFileUpdateVisible=false;a.isInstallUpdateVisible=false;a.initialize()},doProgressIndicator:function(a){if(a===1){YAHOO.util.Dom.setStyle("search_progress_indicator","visibility","visible")}else{setTimeout(function(){YAHOO.util.Dom.setStyle("search_progress_indicator","visibility","hidden")},1000)}},openInBrowser:function(a){var d,b;d=new air.URLVariables();b=new air.URLRequest(a);try{air.navigateToURL(b)}catch(c){alert("Unable to open link!  Please try again.")}},importSearchGrps:function(){var c=this,b,d;b=new air.File();d=new air.FileFilter("Text","*.ssf");try{b.browseForOpen("Open",[d]);b.addEventListener(air.Event.SELECT,function(x){var h,C,D;h=new air.FileStream();h.open(x.target,air.FileMode.READ);C=h.readUTFBytes(h.bytesAvailable);D=YAHOO.lang.JSON.parse(C);if(YAHOO.lang.isObject(D)&&YAHOO.lang.isArray(D.searches)&&D.searches.length>0){var n,l,v,o,f,s,g,G,t,B,p,z,A,F,E,r,k,e,m,u;for(var y=0;y<D.searches.length;y++){n=D.searches[y].search_group_name;v=c.addNewSearchGroup(n);if(!YAHOO.lang.isNull(v.data)){o=v.data[0].id;for(var w=0;w<D.searches[y].search_terms.length;w++){s=D.searches[y].search_terms[w];G=s.search_title;t=c.processSearchDialogData(s.simple_query);B=c.processSearchDialogData(s.ands);z=c.processSearchDialogData(s.ors);A=c.processSearchDialogData(s.nots);p=c.processSearchDialogData(s.phrase);F=c.processSearchDialogData(s.tag);E=c.processSearchDialogData(s.user_from);r=c.processSearchDialogData(s.user_to);k=c.processSearchDialogData(s.ref);e=s.positive_attitude;m=s.negative_attitude;u=s.ask_question;f="q="+t+"&ands="+B+"&phrase="+p+"&ors="+z+"&nots="+A+"&tag="+F+"&from="+E+"&to="+r+"&ref="+k+"&rpp="+100;if(e==="true"){f+="&tude[]=:)"}if(m==="true"){f+="&tude[]=:("}if(u==="true"){f+="&tude[]=?"}g={group_id:o,search_title:G,actual_query_string:f,q:t,ands:B,ors:z,nots:A,phrase:p,tag:F,user_from:E,user_to:r,ref:k,pa:e,na:m,aq:u};c.addSearchItem(g)}l=c.buildTabText(D.searches[y].search_group_name);c.tabView.addTab(new YAHOO.widget.Tab({label:l,active:false,content:'<div id="summary-group-'+o+'" class="tweet-container summary-group-'+o+'"><p id="emptygroup__'+o+'">This group has no search results yet!</p><div>'}))}}c.remove(YAHOO.util.Dom.get("add_new_group"));c.refreshTabStore();c.setupNewTabButton();c.tabView.set("activeIndex",c.tabStore.tabCount-1)}else{alert("Invalid input file!  Unable to complete import process.")}})}catch(a){air.trace("Failed:",a.message)}},stripTags:function(a){if(YAHOO.lang.isString(a)){return a.replace(/<\/?[a-z0-9]+>/gim,"")}},create:function(a){return document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml",a):document.createElement(a)},remove:function(b){var a=b;if(YAHOO.lang.isString(a)){a=YAHOO.util.Dom.get(a)||"undefined"}if(a!=="undefined"){try{a.parentNode.removeChild(a)}catch(c){}}}};YAHOO.AIR.SidelineDB=function(){};YAHOO.AIR.SidelineDB.prototype={db:null,dbFile:null,doQuery:function(e,c){var d=new air.SQLStatement();d.sqlConnection=this.db;d.text=e;if(YAHOO.lang.isObject(c)&&c[0]!=="undefined"){for(var b=0;b<c.length;b++){d.parameters[b]=c[b]}}try{d.execute()}catch(a){air.trace("Error executing SQL:",a);air.trace(a.message);air.trace(d.text);return}return d.getResult()},dbCleanup:function(){var a="DELETE FROM tweets WHERE strftime('%Y-%m-%d %H:%M:%S', loaded_at) < strftime('%Y-%m-%d %H:%M:%S', datetime('now'), '-3 hours') AND sideline_group_id <> "+this.tabStore.favoritesGrpID;this.doQuery(a)},addNewSearchGroup:function(d){var c,b=[d],a="INSERT INTO search_groups VALUES (NULL, ?, 'Y')";this.doQuery(a,b);c=this.doQuery("SELECT last_insert_rowid() as id");return c},updateSearchGroup:function(f,c){var a=this.getGroupIdFromString(f),e=a.data[0].id,d=[],b="UPDATE search_groups SET group_name = ? WHERE id = ?";d[d.length]=c;d[d.length]=e;this.doQuery(b,d);return e},getTweets:function(c){var b=[Number(c)],a="SELECT id, text, from_user, twitter_id, profile_image_url, created_at, sideline_group_id, searches_id FROM tweets WHERE sideline_group_id = ? ORDER BY twitter_id DESC",d=this.doQuery(a,b);return d},getTweetCountForSearchGroup:function(d){var c=0,b=[Number(d)],a="SELECT count(id) AS tweet_count FROM tweets WHERE sideline_group_id = ?",e=this.doQuery(a,b);if(e!==null&&e.data.length===1){c=Number(e.data[0].tweet_count)}return c},getSearchItemParams:function(c){var d=[Number(c)],b="SELECT id, group_id, search_title, q, ands, ors, nots, phrase, tag, user_from, user_to, ref, pa, na, aq FROM searches WHERE id = ?",a=this.doQuery(b,d);return a},markAsFavorite:function(c){var b=[Number(c)],a="UPDATE tweets SET sideline_group_id = "+this.tabStore.favoritesGrpID+" WHERE twitter_id = ?";this.doQuery(a,b)},getUserPreferences:function(){var b,a="SELECT show_desktop_notifications, refresh_rate FROM user_preferences";b=this.doQuery(a);return b},saveUserPreferences:function(){var b=[],a="UPDATE user_preferences SET show_desktop_notifications = ? , refresh_rate = ?";b[b.length]=Number(this.showDesktopNotifications);b[b.length]=Number(this.searchRefreshRate);this.doQuery(a,b)},addTweet:function(k,g,h,l,b,i,a,j,f){var c,d=[],e="INSERT INTO tweets (text, to_user_id, from_user, twitter_id, from_user_id, profile_image_url, created_at, sideline_group_id, searches_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)";d[d.length]=k;d[d.length]=Number(g);d[d.length]=h;d[d.length]=Number(l);d[d.length]=Number(b);d[d.length]=i;d[d.length]=a;d[d.length]=Number(j);d[d.length]=Number(f);this.doQuery(e,d);c=this.doQuery("SELECT last_insert_rowid() as id");return c},removeTweet:function(c){var b=[Number(c)],a="DELETE FROM tweets WHERE twitter_id = ?";this.doQuery(a,b)},removeTabData:function(c){var b=[Number(c)],e="DELETE FROM searches WHERE group_id = ?",a="DELETE FROM tweets WHERE sideline_group_id = ?",d="DELETE FROM search_groups WHERE id = ?";this.doQuery(e,b);this.doQuery(a,b);this.doQuery(d,b)},getGroupIdFromString:function(d){var b=[d],a="SELECT id FROM search_groups WHERE group_name = ?",c=this.doQuery(a,b);return c},getGroupStringFromId:function(c){var b=[c],a="SELECT group_name FROM search_groups WHERE id = ?",d=this.doQuery(a,b);return d},getSidelineGroupQueries:function(c){var b=[Number(c)],a="SELECT id, group_id, search_title, actual_query_string, q, ands, ors, nots, phrase, tag, user_from, user_to, ref, twitter_starting_point FROM searches WHERE active='Y' AND group_id = ?",d=this.doQuery(a,b);return d},getCountOfActiveQueries:function(){var a="SELECT count(id) as total_search_count FROM searches WHERE active='Y'",c=0,b=this.doQuery(a);if(b!==null&&b.data.length===1){c=Number(b.data[0].total_search_count)}return c},getMaxTwitterIdForSearchTerm:function(c){var b=[Number(c)],a="SELECT MAX(twitter_id) as twitter_id FROM tweets WHERE searches_id = ?",d=this.doQuery(a,b);return d},updateMaxTwitterIdForSearchTerm:function(c,d){var b=[],a="UPDATE searches SET twitter_starting_point = ? WHERE id = ?";b[b.length]=Number(c);b[b.length]=Number(d);this.doQuery(a,b)},getSidelineGroups:function(){var a="SELECT tg.id as id, tg.group_name as group_name FROM search_groups tg, tweets t WHERE tg.active='Y' AND tg.id=t.sideline_group_id GROUP BY tg.id ORDER BY group_name ASC",b=this.doQuery(a);return b},getAllSidelineGroups:function(){var a="SELECT id, group_name FROM search_groups WHERE active='Y' ORDER BY id ASC",b=this.doQuery(a);return b},removeSearchItem:function(c){var b=[Number(c)],a="DELETE FROM searches WHERE id = ?";this.doQuery(a,b)},addSearchItem:function(c){var d,b=[],a="INSERT INTO searches (id, group_id, search_title, actual_query_string, q, ands, ors, nots, phrase, tag, user_from, user_to, ref, pa, na, aq, twitter_starting_point, active) VALUES (null, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 0, 'Y')";b[b.length]=Number(c.group_id);b[b.length]=c.search_title;b[b.length]=c.actual_query_string;b[b.length]=c.q;b[b.length]=c.ands;b[b.length]=c.ors;b[b.length]=c.nots;b[b.length]=c.phrase;b[b.length]=c.tag;b[b.length]=c.user_from;b[b.length]=c.user_to;b[b.length]=c.ref;b[b.length]=c.pa;b[b.length]=c.na;b[b.length]=c.aq;this.doQuery(a,b);d=this.doQuery("SELECT last_insert_rowid() as id");return d},updateSearchItem:function(d,c){var b=[],a="UPDATE searches set search_title = ?, actual_query_string = ?, q = ?, ands = ?, ors = ?, nots = ?, phrase = ?, tag = ?, user_from = ?, user_to = ?, ref = ?, pa = ?, na = ?, aq = ?, twitter_starting_point = 0 WHERE id = ?";b[b.length]=c.search_title;b[b.length]=c.actual_query_string;b[b.length]=c.q;b[b.length]=c.ands;b[b.length]=c.ors;b[b.length]=c.nots;b[b.length]=c.phrase;b[b.length]=c.tag;b[b.length]=c.user_from;b[b.length]=c.user_to;b[b.length]=c.ref;b[b.length]=c.pa;b[b.length]=c.na;b[b.length]=c.aq;b[b.length]=d;this.doQuery(a,b)}};(function(){YAHOO.namespace("widget.alert");var a=window.alert;window.alert=function(b){YAHOO.widget.alert.dlg.setBody(b);YAHOO.widget.alert.dlg.cfg.queueProperty("icon",YAHOO.widget.SimpleDialog.ICON_WARN);YAHOO.widget.alert.dlg.cfg.queueProperty("zIndex",9999);YAHOO.widget.alert.dlg.render(document.body);if(YAHOO.widget.alert.dlg.bringToTop){YAHOO.widget.alert.dlg.bringToTop()}YAHOO.widget.alert.dlg.show()};YAHOO.util.Event.on(window,"load",function(){var b=function(){this.hide()};YAHOO.widget.alert.dlg=new YAHOO.widget.SimpleDialog("widget_alert",{visible:false,width:"20em",zIndex:9999,close:false,fixedcenter:true,modal:false,underlay:"none",draggable:false,constraintoviewport:true,icon:YAHOO.widget.SimpleDialog.ICON_WARN,buttons:[{text:"OK",handler:b}]});YAHOO.widget.alert.dlg.setHeader("Alert!");YAHOO.widget.alert.dlg.setBody("Alert body passed to window.alert");YAHOO.widget.alert.dlg.render(document.body)})})();(function(){var d=new YAHOO.AIR.Sideline();YAHOO.lang.augment(YAHOO.AIR.Sideline,YAHOO.AIR.SidelineDB);YAHOO.lang.augment(YAHOO.AIR.Sideline,YAHOO.AIR.SidelineUtil);d.db=new air.SQLConnection();d.dbFile=air.File.applicationStorageDirectory.resolvePath("sideline_v1.db");if(!d.dbFile.exists){var f=air.File.applicationDirectory.resolvePath("sideline_base.db");f.copyTo(d.dbFile,true)}try{d.db.open(d.dbFile);d.db.compact()}catch(a){air.trace("DB error:",a.message);air.trace("Details:",a.details)}if(navigator.platform.indexOf("Win")===0){YAHOO.util.Dom.addClass(document.body,"windowsFontFix")}var c=d.getUserPreferences();if(!YAHOO.lang.isNull(c)&&!YAHOO.lang.isNull(c.data)){d.showDesktopNotifications=c.data[0].show_desktop_notifications;d.searchRefreshRate=c.data[0].refresh_rate}else{d.showDesktopNotifications=1;d.searchRefreshRate=1}d.tabView=new YAHOO.widget.TabView();d.setupSidelineTabs();d.setupTooltip();d.setupRefreshRateSlider();d.searchDialogBuilder();d.searchGrpDialogBuilder();d.renameSearchGrpDialogBuilder();d.searchGrpRemovalDialog();d.searchRateDialogBuilder();window.nativeWindow.addEventListener(air.Event.CLOSING,function(j){j.preventDefault();for(var h=air.NativeApplication.nativeApplication.openedWindows.length-1;h>=0;h--){air.NativeWindow(air.NativeApplication.nativeApplication.openedWindows[h]).close()}});YAHOO.util.Event.on("hd","mousedown",function(){window.nativeWindow.startMove()});d.dbCleanup();setInterval(function(){d.dbCleanup()},10860000);YAHOO.util.Event.on("active_search_container","click",d.activeSearchHandler,d,true);YAHOO.util.Event.on("twitter_trend_list","click",d.handleTrendEvents,d,true);YAHOO.util.Event.on("tweetainer","click",function(i){var h=YAHOO.util.Event.getTarget(i);if(YAHOO.util.Dom.hasClass(h,"close-search-group")){d.searchGrpRemoval.show()}else{if(YAHOO.util.Dom.hasClass(h,"fav_reply_remove")){d.handleTweetReplyFavRemove(h)}else{if(YAHOO.util.Dom.hasClass(h,"tweet_link")){YAHOO.util.Event.preventDefault(i);d.openInBrowser(h.href)}}}});YAHOO.util.Event.on("yui_link","click",function(i){YAHOO.util.Event.preventDefault(i);var h=YAHOO.util.Event.getTarget(i);d.openInBrowser(h.href)});YAHOO.util.Event.on("manual_refresh","click",function(){d.doIntermediateDataRotation.call(d)},d,true);YAHOO.util.Event.onContentReady("options_menu",function(){function j(m,l,o){var n=this.cfg.getProperty("checked"),k=this.value;if(k==="notification"){this.cfg.setProperty("checked",!n);d.showDesktopNotifications=Number(!n);d.saveUserPreferences()}else{if(k==="import"){d.importSearchGrps()}else{if(k==="help"){d.openInBrowser("http://sideline.yahoo.com/help.php")}else{if(k==="rate"){d.searchRateDialog.show()}}}}}var h=[{text:"Import Search Groups",value:"import",onclick:{fn:j}},{text:"Show Notifications",value:"notification",checked:!!d.showDesktopNotifications,onclick:{fn:j}},{text:"Adjust Refresh Rate",value:"rate",onclick:{fn:j}},{text:"Help",value:"help",onclick:{fn:j}}];var i=new YAHOO.widget.Button({type:"menu",label:"Options",name:"menubutton",menu:h,container:this})});d.getTwitterTrends();setInterval(function(){d.getTwitterTrends()},300000);d.dataRotation();d.rotationTimer=setInterval(function(){d.dataRotation()},d.searchRefreshRate*60000);d.doSidelineUpdateCheck();var b,g,e;g=air.NativeApplication.nativeApplication.applicationDescriptor;e=(new DOMParser()).parseFromString(g,"text/xml");b=e.getElementsByTagName("version")[0].firstChild.nodeValue;d.fetchExternalJSONData(d.healthCheck,"http://sideline.yahoo.com/status.php?appversion="+b)})()});
